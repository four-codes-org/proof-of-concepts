

```py
import os
import json
import datetime
import urllib
import boto3
import requests

class ScanToFinalBucket:
    def __init__(self):
        self.s3_client = boto3.client('s3')
        self.sqs_client = boto3.client('sqs')
        self.api_gateway_url = os.environ['API_GATEWAY_URL']
        self.sqs_url = os.environ['SQS_URL']
        self.api_gateway_id = os.environ['API_GATEWAY_ID']
        self.origin_bucket_name = os.environ['ORIGIN_BUCKET_NAME']
        self.success_destination_bucket_name = os.environ['SUCCESS_DESTINATION_BUCKET_NAME']
        self.failed_destination_bucket_name = os.environ['FAILED_DESTINATION_BUCKET_NAME']
        self.alert_sqs_queue_url = os.environ['ALERT_SQS_QUEUE_URL']

    def push_results_to_queue(self, queue_url, file_path, scan_result):
        scanner_status = 'Generated by the scan-to-final-bucket lambda.'
        queue_message = {
            "timestamp": datetime.datetime.now().isoformat(timespec='seconds'),
            "scanner_status": scanner_status,
            "file_path": file_path,
            "scan_result": scan_result
        }
        json_message = json.dumps(queue_message)
        self.sqs_client.send_message(QueueUrl=queue_url, MessageBody=json_message)

    def check_checksum_integrity(self, source_bucket, destination_bucket, file_key):
        source_object = self.s3_client.get_object(Bucket=source_bucket, ChecksumMode='ENABLED', Key=file_key)
        destination_object = self.s3_client.get_object(Bucket=destination_bucket, ChecksumMode='ENABLED', Key=file_key)
        source_has_checksum = 'ETag' in source_object
        destination_has_checksum = 'ETag' in destination_object
        return source_has_checksum and destination_has_checksum and source_object['ETag'] == destination_object['ETag']

    def delete_queue_message(self, sqs_url, receipt_handle):
        self.sqs_client.delete_message(QueueUrl=sqs_url, ReceiptHandle=receipt_handle)

    def check_object_exists(self, bucket_name, file_key):
        try:
            self.s3_client.head_object(Bucket=bucket_name, Key=file_key)
            return True
        except self.s3_client.exceptions.ClientError as e:
            return e.response['Error']['Code'] != '404'

    def process_event(self, event):
        receipt_handle = event['ReceiptHandle']
        s3_data = json.loads(event['Body'])
        file_key = urllib.parse.unquote_plus(s3_data['detail']['requestParameters']['key'])
        source_bucket_name = urllib.parse.unquote_plus(s3_data['detail']['requestParameters']['bucketName'])
        copy_object = {'Bucket': source_bucket_name, 'Key': file_key}

        if self.check_object_exists(source_bucket_name, file_key):
            tags = self.s3_client.get_object_tagging(Bucket=source_bucket_name, Key=file_key)
            tag_set = tags['TagSet']
            scan_result_tag = next((tag for tag in tag_set if tag['Key'] == 'fss-scan-result'), None)
            scan_result_value = scan_result_tag['Value'] if scan_result_tag else None

            if scan_result_value == 'no issues found':
                has_checksum = self.check_checksum_integrity(self.origin_bucket_name, source_bucket_name, file_key)
                destination_bucket_name = self.success_destination_bucket_name if has_checksum else self.failed_destination_bucket_name
                self.s3_client.copy_object(CopySource=copy_object, Bucket=destination_bucket_name, Key=file_key)
                self.s3_client.delete_object(Bucket=source_bucket_name, Key=file_key)
                self.push_results_to_queue(self.alert_sqs_queue_url, file_key, "success" if has_checksum else "failure")
            else:
                self.s3_client.copy_object(CopySource=copy_object, Bucket=self.failed_destination_bucket_name, Key=file_key)
                self.s3_client.delete_object(Bucket=source_bucket_name, Key=file_key)
                self.push_results_to_queue(self.alert_sqs_queue_url, file_key, "failure")

        self.delete_queue_message(self.sqs_url, receipt_handle)

    def lambda_handler(self):
        while True:
            res = requests.get(self.api_gateway_url, headers={"x-apigw-api-id": self.api_gateway_id})
            if res.status_code == 200:
                stage_one = res.json()
                if stage_one['ReceiveMessageResponse']['ReceiveMessageResult']['messages'] is None:
                    print(json.dumps({"Message": False, "statusCode": 200}))
                    break
                events = stage_one['ReceiveMessageResponse']['ReceiveMessageResult']['messages']
                for event in events:
                    self.process_event(event)
            else:
                print(json.dumps({"Message": "api issues", "statusCode": 500}))
                break

def lambda_handler(event, context):
    scan_to_final_bucket = ScanToFinalBucket()
    scan_to_final_bucket.lambda_handler()

```
